<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>WebKurier ‚Ä¢ –õ–æ–≥–∏ —Å–∏—Å—Ç–µ–º—ã</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <style>
    body {
      margin: 0;
      padding: 20px;
      font-family: "Courier New", monospace;
      background: #0d0d0f;
      color: #e5e5e5;
    }
    h1 {
      text-align: center;
      margin-bottom: 20px;
      font-size: 1.8rem;
    }

    .controls {
      display: flex;
      gap: 10px;
      justify-content: center;
      margin-bottom: 20px;
      flex-wrap: wrap;
    }

    select, button {
      padding: 8px 14px;
      font-size: 15px;
      border-radius: 6px;
      border: 1px solid #444;
      background: #1b1b20;
      color: #fff;
    }

    button {
      cursor: pointer;
      background: #3030ff;
      border-color: #2222cc;
    }

    #logs-container {
      margin-top: 15px;
      border: 1px solid #333;
      padding: 15px;
      border-radius: 8px;
      background: #111;
      max-height: 70vh;
      overflow-y: auto;
      white-space: pre-wrap;
      font-size: 14px;
    }

    .log-entry {
      padding: 6px 0;
      border-bottom: 1px dashed #333;
    }

    .log-entry:last-child {
      border-bottom: none;
    }

    .log-info { color: #7cd1ff; }
    .log-warning { color: #ffe37c; }
    .log-error { color: #ff7c7c; }
    .log-debug { color: #9e9e9e; }
  </style>
</head>

<body>

<h1>üìú –õ–æ–≥–∏ —Å–∏—Å—Ç–µ–º—ã WebKurier</h1>

<div class="controls">
  <select id="source">
    <option value="all">–ò—Å—Ç–æ—á–Ω–∏–∫: –í—Å–µ</option>
    <option value="core">Core</option>
    <option value="drone">Drone</option>
    <option value="security">Security</option>
    <option value="hybrid">Hybrid</option>
  </select>

  <select id="level">
    <option value="info">–£—Ä–æ–≤–µ–Ω—å: INFO</option>
    <option value="warning">WARNING</option>
    <option value="error">ERROR</option>
    <option value="debug">DEBUG</option>
  </select>

  <select id="limit">
    <option value="50">50 –∑–∞–ø–∏—Å–µ–π</option>
    <option value="100" selected>100 –∑–∞–ø–∏—Å–µ–π</option>
    <option value="200">200 –∑–∞–ø–∏—Å–µ–π</option>
    <option value="500">500 –∑–∞–ø–∏—Å–µ–π</option>
  </select>

  <button onclick="loadLogs()">–ó–∞–≥—Ä—É–∑–∏—Ç—å</button>
</div>

<div id="logs-container">–ù–∞–∂–º–∏—Ç–µ ‚Äú–ó–∞–≥—Ä—É–∑–∏—Ç—å‚Äù.</div>

<script>
  const ADMIN_TOKEN = "ADMIN_TOKEN_HERE"; // ‚Üê –ø–æ–¥–º–µ–Ω–∏—à—å

  async function loadLogs() {
    const source = document.getElementById("source").value;
    const level  = document.getElementById("level").value;
    const limit  = document.getElementById("limit").value;

    const url = `/api/admin/logs?source=${source}&level=${level}&limit=${limit}`;

    const res = await fetch(url, {
      headers: {
        "Authorization": "Bearer " + ADMIN_TOKEN
      }
    });

    const data = await res.json();
    const box = document.getElementById("logs-container");

    if (!data.ok) {
      box.innerHTML = "–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –ª–æ–≥–æ–≤.";
      return;
    }

    box.innerHTML = "";
    data.entries.forEach(entry => {
      const el = document.createElement("div");
      el.classList.add("log-entry");

      let lvlClass = "log-info";
      if (entry.level === "warning") lvlClass = "log-warning";
      if (entry.level === "error") lvlClass = "log-error";
      if (entry.level === "debug") lvlClass = "log-debug";

      el.innerHTML =
        `[${entry.timestamp}] <span class="${lvlClass}">${entry.level.toUpperCase()}</span> `
        + `[${entry.source}] ‚Äî ${entry.message}`;

      box.appendChild(el);
    });

    if (data.entries.length === 0) {
      box.innerHTML = "–õ–æ–≥–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç.";
    }
  }
</script>

</body>
</html>