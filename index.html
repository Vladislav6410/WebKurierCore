<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <title>WebKurierCore ¬∑ –¢–µ—Ä–º–∏–Ω–∞–ª, WebCoin –∏ –∞–≥–µ–Ω—Ç—ã</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <style>
    :root {
      --bg-light: #f4f4f4;
      --bg-dark: #121212;
      --text-light: #1a1a1a;
      --text-dark: #f4f4f4;
      --link-light: #007acc;
      --link-dark: #66ccff;
      --accent-light: #007acc;
      --accent-dark: #00bfff;
      --btn-bg-light: #ffffff;
      --btn-bg-dark: #1e1e1e;
      --btn-border: #ccc;
      --coin-bg: #3a3a3a;
    }

    /* ---------------------- BODY / THEME ---------------------- */

    body {
      margin: 0;
      padding: 0;
      font-family: 'Courier New', Courier, monospace;
      background-color: var(--bg-light);
      color: var(--text-light);
      transition: background-color 0.3s, color 0.3s;
    }

    body.dark-theme {
      background-color: var(--bg-dark);
      color: var(--text-dark);
    }

    main {
      max-width: 960px;
      margin: 0 auto;
      padding: 20px 16px 40px;
    }

    header {
      text-align: center;
      margin-bottom: 20px;
    }

    h1, h2, h3 {
      text-align: center;
      margin-top: 20px;
      margin-bottom: 8px;
    }

    p.subtitle {
      margin-top: 6px;
      font-size: 0.95rem;
      opacity: 0.8;
    }

    a {
      color: var(--link-light);
      text-decoration: none;
    }
    body.dark-theme a {
      color: var(--link-dark);
    }

    /* ---------------------- BUTTONS ---------------------- */

    button, .btn {
      padding: 10px 20px;
      margin: 10px;
      font-size: 16px;
      cursor: pointer;
      border: 1px solid var(--btn-border);
      background-color: var(--btn-bg-light);
      color: var(--text-light);
      transition: background-color 0.3s, color 0.3s;
      border-radius: 5px;
    }

    body.dark-theme button,
    body.dark-theme .btn {
      background-color: var(--btn-bg-dark);
      color: var(--text-dark);
    }

    /* ---------------------- CARDS / LAYOUT ---------------------- */

    .row {
      display: flex;
      flex-wrap: wrap;
      gap: 20px;
      justify-content: center;
      align-items: flex-start;
      margin-top: 10px;
    }

    .card {
      border-radius: 10px;
      border: 1px solid var(--btn-border);
      padding: 16px 18px;
      box-sizing: border-box;
      background-color: rgba(255,255,255,0.8);
    }

    body.dark-theme .card {
      background-color: rgba(0,0,0,0.4);
    }

    .card-half {
      flex: 1 1 280px;
      max-width: 460px;
    }

    /* ---------------------- WALLET ---------------------- */

    .wallet {
      margin-top: 10px;
      padding: 16px;
      border: 1px solid var(--btn-border);
      border-radius: 8px;
      background-color: rgba(255,255,255,0.05);
      display: inline-block;
    }
    .wallet h2 {
      margin-bottom: 10px;
      text-align: left;
    }
    .wallet .balance-label {
      font-size: 0.9rem;
      opacity: 0.8;
      margin-bottom: 4px;
    }
    .wallet .balance {
      font-size: 24px;
      font-weight: bold;
      margin-bottom: 10px;
    }
    .wallet button {
      font-weight: bold;
      font-size: 14px;
      margin: 4px 4px 0 0;
    }

    #balance-display {
      font-size: 18px;
      margin-top: 10px;
      background-color: var(--coin-bg);
      color: #fff;
      padding: 8px 10px;
      border-radius: 8px;
      display: inline-block;
    }

    /* ---------------------- TERMINAL ---------------------- */

    .terminal {
      background-color: #000;
      color: #00ff00;
      font-family: 'Courier New', monospace;
      padding: 16px;
      margin-top: 10px;
      min-height: 260px;
      overflow-y: auto;
      border-radius: 10px;
      border: 1px solid #444;
      white-space: pre-wrap;
      text-align: left;
      box-shadow: 0 2px 10px rgba(0,0,0,0.2);
    }

    #terminal-input {
      display: block;
      margin: 12px auto 0;
      width: 100%;
      font-size: 14px;
      padding: 8px 10px;
      border-radius: 6px;
      border: 1px solid #aaa;
      background-color: #fff;
      color: #000;
      font-family: 'Courier New', monospace;
      box-sizing: border-box;
    }

    body.dark-theme #terminal-input {
      background-color: #1a1a1a;
      color: #f4f4f4;
      border: 1px solid #555;
    }

    /* ---------------------- THEME TOGGLE ---------------------- */

    .toggle-theme {
      position: fixed;
      top: 15px;
      right: 15px;
      z-index: 1000;
      padding: 8px 16px;
      border-radius: 5px;
      background-color: var(--accent-light);
      color: #fff;
      border: none;
      cursor: pointer;
    }
    body.dark-theme .toggle-theme {
      background-color: var(--accent-dark);
    }

    /* ---------------------- PRELOADER ---------------------- */

    #preloader {
      position: fixed;
      width: 100%;
      height: 100%;
      background: var(--bg-light);
      z-index: 9999;
      top: 0;
      left: 0;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: opacity 0.5s;
    }
    body.dark-theme #preloader {
      background: var(--bg-dark);
    }

    .loader {
      width: 40px;
      height: 40px;
      border: 5px solid #ccc;
      border-top-color: #333;
      border-radius: 50%;
      animation: spin 1s linear infinite;
    }
    @keyframes spin {
      to { transform: rotate(360deg); }
    }

    /* ---------------------- AGENTS MENU ---------------------- */

    #agents-section {
      margin-top: 30px;
    }

    .agents-menu {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
      gap: 16px;
      margin-top: 12px;
    }

    .agent-group-card {
      border: 1px solid #444;
      border-radius: 10px;
      padding: 12px 14px;
      background: #111;
      color: #f4f4f4;
    }

    body.dark-theme .agent-group-card {
      background: #111;
    }

    .agent-group-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 8px;
    }

    .agent-group-title {
      font-weight: 600;
      font-size: 1.05rem;
    }

    .agent-group-icon {
      font-size: 1.4rem;
      margin-right: 6px;
    }

    .agent-group-agents {
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
      margin-top: 6px;
    }

    .agent-chip {
      padding: 4px 8px;
      border-radius: 999px;
      font-size: 0.8rem;
      border: 1px solid #555;
      cursor: pointer;
      white-space: nowrap;
      background: #000;
      color: #f4f4f4;
    }

    .agent-chip.disabled {
      opacity: 0.4;
      cursor: default;
    }

    .agent-access-badge {
      font-size: 0.72rem;
      text-transform: uppercase;
      opacity: 0.7;
    }

    /* ---------------------- FOOTER / LINKS ---------------------- */

    footer {
      margin-top: 40px;
      text-align: center;
      font-size: 0.85rem;
      opacity: 0.7;
    }

    footer a {
      text-decoration: underline;
    }

    /* ---------------------- MOBILE ---------------------- */

    @media (max-width: 600px) {
      button, .btn {
        width: 90%;
        font-size: 14px;
      }
      #terminal-input {
        font-size: 14px;
      }
      .row {
        flex-direction: column;
      }
    }
  </style>
</head>
<body>

  <!-- –ü—Ä–µ–ª–æ–∞–¥–µ—Ä -->
  <div id="preloader">
    <div class="loader"></div>
  </div>

  <!-- –ü–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å —Ç–µ–º—ã -->
  <button class="toggle-theme" id="toggle-theme-btn">üåì Theme</button>

  <main>
    <header>
      <h1>WebKurierCore ¬∑ –¢–µ—Ä–º–∏–Ω–∞–ª –∏ –∞–≥–µ–Ω—Ç—ã</h1>
      <p class="subtitle">
        –ï–¥–∏–Ω–æ–µ —è–¥—Ä–æ: WebCoin-–∫–æ—à–µ–ª—ë–∫, —Ç–µ—Ä–º–∏–Ω–∞–ª –∏–Ω–∂–µ–Ω–µ—Ä–∞ –∏ –¥–æ—Å—Ç—É–ø –∫ –∞–≥–µ–Ω—Ç–∞–º WebKurier.
      </p>
    </header>

    <!-- –û—Å–Ω–æ–≤–Ω–æ–π —Ä—è–¥: –∫–æ—à–µ–ª—ë–∫ + —Ç–µ—Ä–º–∏–Ω–∞–ª -->
    <div class="row">
      <!-- WebCoin-–∫–æ—à–µ–ª—ë–∫ -->
      <section class="card card-half">
        <h2>WebCoin Wallet</h2>
        <p style="font-size:0.9rem; opacity:0.8;">
          –õ–æ–∫–∞–ª—å–Ω—ã–π —Ç–µ—Å—Ç–æ–≤—ã–π –±–∞–ª–∞–Ω—Å. –ü–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è –∫ WebKurierChain –∏ Telegram/WebApp.
        </p>

        <div class="wallet">
          <div class="balance-label">–¢–µ–∫—É—â–∏–π –±–∞–ª–∞–Ω—Å:</div>
          <div id="balance-display">0 WEB</div>

          <div style="margin-top:10px;">
            <button onclick="addCoins(10)">+10 WEB</button>
            <button onclick="addCoins(50)">+50 WEB</button>
            <button onclick="resetCoins()">üîÅ –°–±—Ä–æ—Å</button>
          </div>
        </div>
      </section>

      <!-- –¢–µ—Ä–º–∏–Ω–∞–ª -->
      <section class="card card-half">
        <h2>–¢–µ—Ä–º–∏–Ω–∞–ª –∏–Ω–∂–µ–Ω–µ—Ä–∞</h2>
        <p style="font-size:0.9rem; opacity:0.8;">
          –ö–æ–º–∞–Ω–¥—ã: <code>help</code>, <code>ping</code>, <code>balance</code>, <code>/add &lt;—á–∏—Å–ª–æ&gt;</code>.
        </p>

        <div id="terminal" class="terminal"></div>
        <input
          id="terminal-input"
          type="text"
          placeholder="–í–≤–µ–¥–∏—Ç–µ –∫–æ–º–∞–Ω–¥—É –∏ –Ω–∞–∂–º–∏—Ç–µ Enter..."
        />
      </section>
    </div>

    <!-- –ú–µ–Ω—é –∞–≥–µ–Ω—Ç–æ–≤ -->
    <section id="agents-section">
      <h2 id="agents-title">–ê–≥–µ–Ω—Ç—ã WebKurier</h2>
      <p style="text-align:center; font-size:0.9rem; opacity:0.8;">
        –ù–∏–∂–µ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –≥—Ä—É–ø–ø—ã –∞–≥–µ–Ω—Ç–æ–≤. –ù–∞–±–æ—Ä –∏ –¥–æ—Å—Ç—É–ø –∑–∞–≤–∏—Å—è—Ç –æ—Ç –ø–æ–¥–ø–∏—Å–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.
      </p>
      <div id="agents-menu" class="agents-menu"></div>
    </section>

    <!-- –°—Å—ã–ª–∫–∏ –Ω–∞ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã / –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é -->
    <footer>
      <p>
        –ü–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–∏ –ø–æ –≥–µ–æ–¥–µ–∑–∏–∏ –∏ 3D-–Ω–∞–±–æ—Ä—É —Å–º. –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ:<br />
        <a href="docs/geodesy.html">Geodesy &amp; 3D Suite (WebKurierDroneHybrid)</a>
      </p>
      <p>¬© WebKurier, –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–æ –≤ –ì–µ—Ä–º–∞–Ω–∏–∏.</p>
    </footer>
  </main>

  <!-- –õ–æ–≥–∏–∫–∞ —Ç–µ–º—ã –∏ –ø—Ä–µ–ª–æ–∞–¥–µ—Ä–∞ -->
  <script>
    (function() {
      const STORAGE_KEY = 'webkurier_theme';
      const body = document.body;
      const btn = document.getElementById('toggle-theme-btn');

      function applyTheme(theme) {
        if (theme === 'dark') {
          body.classList.add('dark-theme');
        } else {
          body.classList.remove('dark-theme');
        }
      }

      // –ó–∞–≥—Ä—É–∑–∫–∞ —Ç–µ–º—ã –∏–∑ localStorage
      const saved = localStorage.getItem(STORAGE_KEY) || 'light';
      applyTheme(saved);

      if (btn) {
        btn.addEventListener('click', () => {
          const current = body.classList.contains('dark-theme') ? 'dark' : 'light';
          const next = current === 'dark' ? 'light' : 'dark';
          applyTheme(next);
          localStorage.setItem(STORAGE_KEY, next);
        });
      }

      // –ü—Ä–µ–ª–æ–∞–¥–µ—Ä
      window.addEventListener('load', () => {
        const preloader = document.getElementById('preloader');
        if (preloader) {
          preloader.style.opacity = '0';
          setTimeout(() => preloader.style.display = 'none', 500);
        }
      });
    })();
  </script>

  <!-- –õ–æ–∫–∞–ª—å–Ω–∞—è –ª–æ–≥–∏–∫–∞ WebCoin-–∫–æ—à–µ–ª—å–∫–∞ -->
  <script>
    (function() {
      const STORAGE_KEY = 'webcoin_balance';
      const display = document.getElementById('balance-display');

      function syncDisplay(balance) {
        if (display) {
          display.textContent = balance + ' WEB';
        }
      }

      function getBalance() {
        const raw = localStorage.getItem(STORAGE_KEY);
        const value = raw ? parseInt(raw, 10) : 0;
        return isNaN(value) ? 0 : value;
      }

      function setBalance(value) {
        const fixed = value < 0 ? 0 : value;
        localStorage.setItem(STORAGE_KEY, String(fixed));
        syncDisplay(fixed);
      }

      // –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ–º –≤ –≥–ª–æ–±–∞–ª—å–Ω—É—é –æ–±–ª–∞—Å—Ç—å –¥–ª—è –∫–Ω–æ–ø–æ–∫
      window.addCoins = function(amount) {
        const current = getBalance();
        setBalance(current + (amount || 0));
      };

      window.resetCoins = function() {
        setBalance(0);
      };

      // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
      setBalance(getBalance());
    })();
  </script>

  <!-- –õ–æ–≥–∏–∫–∞ —Ç–µ—Ä–º–∏–Ω–∞–ª–∞ -->
  <script>
    (function() {
      const term = document.getElementById('terminal');
      const input = document.getElementById('terminal-input');

      function println(text) {
        if (!term) return;
        term.textContent += text + '\\n';
        term.scrollTop = term.scrollHeight;
      }

      function handleCommand(cmd) {
        const trimmed = cmd.trim();
        if (!trimmed) return;

        println('> ' + trimmed);

        const [base, ...args] = trimmed.split(/\s+/);

        switch (base.toLowerCase()) {
          case 'help':
            println('–î–æ—Å—Ç—É–ø–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã:');
            println('  help        ‚Äî –ø–æ–∫–∞–∑–∞—Ç—å —ç—Ç–æ —Å–æ–æ–±—â–µ–Ω–∏–µ');
            println('  ping        ‚Äî –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è');
            println('  balance     ‚Äî –ø–æ–∫–∞–∑–∞—Ç—å –±–∞–ª–∞–Ω—Å WebCoin');
            println('  /add N      ‚Äî –¥–æ–±–∞–≤–∏—Ç—å N WEB');
            println('');
            break;

          case 'ping':
            println('pong');
            println('');
            break;

          case 'balance':
            if (typeof localStorage !== 'undefined') {
              const raw = localStorage.getItem('webcoin_balance');
              const val = raw ? parseInt(raw, 10) : 0;
              println('–¢–µ–∫—É—â–∏–π –±–∞–ª–∞–Ω—Å: ' + (isNaN(val) ? 0 : val) + ' WEB');
            } else {
              println('–•—Ä–∞–Ω–∏–ª–∏—â–µ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ.');
            }
            println('');
            break;

          case '/add':
            if (args.length === 0) {
              println('–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ: /add N   (–ø—Ä–∏–º–µ—Ä: /add 10)');
            } else {
              const n = parseInt(args[0], 10);
              if (isNaN(n)) {
                println('–û—à–∏–±–∫–∞: N –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å —á–∏—Å–ª–æ–º.');
              } else if (typeof window.addCoins === 'function') {
                window.addCoins(n);
                println('–î–æ–±–∞–≤–ª–µ–Ω–æ: ' + n + ' WEB');
              } else {
                println('–§—É–Ω–∫—Ü–∏—è addCoins –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞.');
              }
            }
            println('');
            break;

          default:
            println('–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –∫–æ–º–∞–Ω–¥–∞: ' + base);
            println("–ù–∞–±–µ—Ä–∏—Ç–µ 'help' –¥–ª—è —Å–ø–∏—Å–∫–∞ –∫–æ–º–∞–Ω–¥.");
            println('');
        }
      }

      if (term) {
        println('WebKurierCore Terminal');
        println('–í–≤–µ–¥–∏—Ç–µ "help" –¥–ª—è —Å–ø–∏—Å–∫–∞ –∫–æ–º–∞–Ω–¥.');
        println('');
      }

      if (input) {
        input.addEventListener('keydown', (e) => {
          if (e.key === 'Enter') {
            e.preventDefault();
            const value = input.value;
            input.value = '';
            handleCommand(value);
          }
        });
      }
    })();
  </script>

  <!-- –ú–µ–Ω—é –∞–≥–µ–Ω—Ç–æ–≤ (–¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ agents_map.json) -->
  <script src="engine/ui/agents-menu.js"></script>

</body>
</html>


